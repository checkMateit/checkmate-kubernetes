kube-prometheus-stack:
  crds:
    enabled: false

  grafana:
    enabled: true
    adminPassword: admin
    service:
      type: ClusterIP
    sidecar:
      datasources:
        enabled: true

  prometheus:
    enabled: true
    prometheusSpec:
      retention: 7d
      scrapeInterval: 30s

  alertmanager:
    enabled: true
    config:
      global:
        resolve_timeout: 5m
      route:
        receiver: discord-webhook
        group_wait: 30s
        group_interval: 5m
        repeat_interval: 4h
      receivers:
        - name: discord-webhook
          webhook_configs:
            - url_file: /etc/alertmanager/secrets/discord-webhook/url
              send_resolved: true
    alertmanagerSpec:
      replicas: 1
      secrets:
        - discord-webhook

loki:
  loki:
    auth_enabled: false
    commonConfig:
      replication_factor: 1
    storage:
      type: filesystem
      bucketNames:
        chunks: chunks
        ruler: ruler
        admin: admin
    schemaConfig:
      configs:
        - from: "2024-01-01"
          store: tsdb
          object_store: filesystem
          schema: v13
          index:
            prefix: loki_index_
            period: 24h
    storage_config:
      filesystem:
        directory: /var/loki/chunks
      tsdb_shipper:
        active_index_directory: /var/loki/tsdb-index
        cache_location: /var/loki/tsdb-cache
  deploymentMode: SingleBinary
  singleBinary:
    replicas: 1
  test:
    enabled: false

promtail:
  config:
    clients:
      - url: http://monitoring-loki.monitoring.svc.cluster.local:3100/loki/api/v1/push
